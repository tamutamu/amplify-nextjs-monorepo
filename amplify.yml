version: 1
applications:
  - appRoot: frontend/app
    frontend:
      phases:
        preBuild:
          commands:
            - cd ../../
            - yarn
        build:
          commands:
            - cd frontend/app
            - yarn build
      artifacts:
        baseDirectory: out
        files:
          - "**/*"
      cache:
        paths:
          - ../../node_modules
          - ./node_modules
          - .next/cache/**/*
  - appRoot: backend
    backend:
      phases:
        build:
          commands:
            - "# Execute Amplify CLI with the helper script"
            - amplifyPush --simple
    frontend:
      phases:
        build:
          commands:
            - echo "build"
      artifacts:
        baseDirectory: out
        files:
          - "**/*"
      cache:
        paths:
          - ../../node_modules
          - ./node_modules
          - .next/cache/**/*
